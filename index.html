<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Report: Scaling macOS Software Deployment</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .workflow-arrow {
            color: #cbd5e1; /* slate-300 */
            font-size: 2rem;
            line-height: 1;
        }
        .nav-item.active {
            background-color: #0284c7; /* sky-600 */
            color: white;
            box-shadow: 0 4px 14px 0 rgb(2 132 199 / 39%);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 50vh;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
    </style>
</head>
<body class="text-slate-700">

    <header class="py-8 md:py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-3xl md:text-5xl font-bold text-slate-900">Scaling macOS Software Deployment</h1>
            <p class="mt-4 text-lg md:text-xl text-slate-600">An advanced, automated, scalable, and intelligent package management workflow.</p>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- Interactive Workflow Navigation -->
        <section id="workflow-nav-section" class="sticky top-0 z-10 bg-f8fafc/80 backdrop-blur-sm py-4 mb-12">
            <div class="container mx-auto px-4">
                 <p class="text-center text-sm font-semibold text-slate-600 mb-4">Click any stage to explore the details</p>
                <div id="workflow-nav-container" class="flex flex-wrap items-center justify-center gap-x-2 md:gap-x-4 gap-y-3">
                    <a href="#developer" data-target="developer" class="nav-item flex-shrink-0 text-xs md:text-sm font-semibold py-2 px-3 md:px-4 rounded-full shadow-sm bg-white border border-slate-200 hover:bg-slate-100 transition-all duration-200">Development</a>
                    <div class="workflow-arrow flex-shrink-0">&#8594;</div>
                    <a href="#pipeline" data-target="pipeline" class="nav-item flex-shrink-0 text-xs md:text-sm font-semibold py-2 px-3 md:px-4 rounded-full shadow-sm bg-white border border-slate-200 hover:bg-slate-100 transition-all duration-200">CI/CD Pipeline</a>
                    <div class="workflow-arrow flex-shrink-0">&#8594;</div>
                    <a href="#backend" data-target="backend" class="nav-item flex-shrink-0 text-xs md:text-sm font-semibold py-2 px-3 md:px-4 rounded-full shadow-sm bg-white border border-slate-200 hover:bg-slate-100 transition-all duration-200">Serverless Backend</a>
                    <div class="workflow-arrow flex-shrink-0">&#8594;</div>
                    <a href="#client" data-target="client" class="nav-item flex-shrink-0 text-xs md:text-sm font-semibold py-2 px-3 md:px-4 rounded-full shadow-sm bg-white border border-slate-200 hover:bg-slate-100 transition-all duration-200">Client Deployment</a>
                    <div class="workflow-arrow flex-shrink-0">&#8594;</div>
                    <a href="#reporting" data-target="reporting" class="nav-item flex-shrink-0 text-xs md:text-sm font-semibold py-2 px-3 md:px-4 rounded-full shadow-sm bg-white border border-slate-200 hover:bg-slate-100 transition-all duration-200">Intelligent Reporting</a>
                </div>
            </div>
        </section>

        <!-- Content Sections -->
        <div class="space-y-20 md:space-y-32">
            
            <section id="developer" class="scroll-mt-32">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-slate-800">The Development Workflow</h2>
                    <p class="mt-3 max-w-2xl mx-auto text-lg text-slate-600">This section describes the tools and processes developers use to introduce new software or updates. The goal is a consistent, repeatable process where what works locally is guaranteed to work in production.</p>
                </div>
                <div class="mt-12 grid md:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200/50">
                        <h3 class="text-xl font-semibold text-sky-700">1. AutoPkg: The Automation Engine</h3>
                        <p class="mt-2">The foundation of our workflow. AutoPkg automatically downloads, repackages, and imports software into our testing repository using simple, maintainable `XML` or `YAML` recipes.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200/50">
                        <h3 class="text-xl font-semibold text-sky-700">2. Makefile: The Universal Glue</h3>
                        <p class="mt-2">A simple yet powerfull `Makefile` provides a consistent interface for all operations, like just `make`. It works identically on a developer's laptop and in the CI/CD pipeline. No surprises.</p>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200/50">
                        <h3 class="text-xl font-semibold text-sky-700">3. Git/GitLab: The Source of Truth</h3>
                        <p class="mt-2">All recipes and the Makefile are stored in a Git repository. GitLab serves as our central hub for collaboration, code reviews, and triggering the automated CI/CD pipeline on every merge.</p>
                    </div>
                </div>
            </section>

            <section id="pipeline" class="scroll-mt-32">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-slate-800">The CI/CD Pipeline</h2>
                    <p class="mt-3 max-w-2xl mx-auto text-lg text-slate-600">Once a developer merges a change, GitLab CI takes over. This automated pipeline builds the entire software repository and deploys it, ensuring a hands-off, error-free release process.</p>
                </div>
                <div class="mt-12 flex flex-col md:flex-row items-center justify-center gap-8 text-center">
                     <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200/50 flex-1">
                        <div class="text-2xl font-bold text-sky-600">Step 1</div>
                        <h3 class="text-xl font-semibold text-slate-800 mt-2">Build & Test</h3>
                        <p class="mt-2">The CI runner spins up a clean environment, checks out the code, and runs just `make` to build a complete, updated Munki repository.</p>
                    </div>
                    <div class="text-4xl font-light text-slate-400 mx-4">&#10140;</div>
                     <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200/50 flex-1">
                        <div class="text-2xl font-bold text-sky-600">Step 2</div>
                        <h3 class="text-xl font-semibold text-slate-800 mt-2">Package & Deploy to S3</h3>
                        <p class="mt-2">Upon a successful build, the CI job securely syncs the entire repository to a private Amazon S3 bucket, our robust and cost-effective package source.</p>
                    </div>
                </div>
            </section>

            <section id="backend" class="scroll-mt-32">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-slate-800">The Serverless Backend</h2>
                    <p class="mt-3 max-w-2xl mx-auto text-lg text-slate-600">We replaced traditional web servers with a modern, scalable AWS serverless architecture. This reduces cost and maintenance overhead, allowing us to pay only for what we use while ensuring high performance globally.</p>
                </div>
                <div class="mt-12 flex flex-col md:flex-row items-center justify-center gap-x-4 gap-y-4 text-center">
                    <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200/50 w-full md:w-auto flex-1">
                        <h3 class="font-bold text-lg text-slate-800">Amazon S3</h3>
                        <p class="text-sm">Origin package storage</p>
                    </div>
                    <div class="flex items-center justify-center text-2xl text-slate-400 transform md:rotate-0 rotate-90">&rarr;</div>
                    <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200/50 w-full md:w-auto flex-1">
                        <h3 class="font-bold text-lg text-slate-800">Lambda</h3>
                        <p class="text-sm">On-demand compute for custom logic</p>
                    </div>
                    <!-- <div class="flex items-center justify-center text-2xl text-slate-400 transform md:rotate-0 rotate-90">&rarr;</div>
                    <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200/50 w-full md:w-auto flex-1">
                        <h3 class="font-bold text-lg text-slate-800">API Gateway</h3>
                        <p class="text-sm">Handles requests and logic</p>
                    </div> -->
                    <div class="flex items-center justify-center text-2xl text-slate-400 transform md:rotate-0 rotate-90">&rarr;</div>
                    <div class="bg-white p-6 rounded-lg shadow-md border border-slate-200/50 w-full md:w-auto flex-1">
                        <h3 class="font-bold text-lg text-slate-800">CloudFront</h3>
                        <p class="text-sm">Global CDN for fast downloads</p>
                    </div>
                </div>
            </section>

            <section id="client" class="scroll-mt-32">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-slate-800">Client Deployment & Experience</h2>
                    <p class="mt-3 max-w-2xl mx-auto text-lg text-slate-600">This section covers how the software is delivered to end-user Macs. We use Jamf Pro for initial setup and Munki's Managed Software Center to provide a seamless, App Store-like experience for users.</p>
                </div>
                <div class="mt-12 grid md:grid-cols-2 gap-8">
                    <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200/50">
                        <h3 class="text-2xl font-semibold text-slate-800">Jamf Pro: The Provisioning Layer</h3>
                        <p class="mt-4">Jamf is our primary tool for device enrollment and configuration. During enrollment, a policy automatically installs the Munki client and configures it to point to our secure CloudFront distribution URL.</p>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200/50">
                        <h3 class="text-2xl font-semibold text-slate-800">Managed Software Center (MSC)</h3>
                        <p class="mt-4">For the end-user, MSC provides a company-approved App Store. It runs quietly, checking for updates and notifying the user, allowing them to install on their schedule. It also offers a catalog of optional software for self-service installation.</p>
                    </div>
                </div>
            </section>

             <section id="reporting" class="scroll-mt-32">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-slate-800">The Payoff: Intelligent Reporting</h2>
                    <p class="mt-3 max-w-2xl mx-auto text-lg text-slate-600">You can't manage what you can't measure. Munki client logs are sent to Snowflake, our data warehouse, where we build Streamlit dashboards to get instant, actionable insights on our entire fleet's software health.</p>
                </div>
                <div class="mt-12 bg-white p-6 md:p-8 rounded-2xl shadow-xl border border-slate-200/50">
                    <h3 class="text-center text-xl font-semibold text-slate-800 mb-4">Live Dashboard: Software Patch Compliance</h3>
                    <div class="text-center mb-6">
                        <p class="text-sm text-slate-500">Click to simulate filtering the data.</p>
                        <div class="mt-2 space-x-2">
                             <button id="filter-all" class="filter-btn bg-sky-600 text-white py-1 px-4 rounded-full text-sm font-medium">All Apps</button>
                             <button id="filter-critical" class="filter-btn bg-white text-slate-600 border border-slate-300 py-1 px-4 rounded-full text-sm font-medium">Critical Only</button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="reportingChart"></canvas>
                    </div>
                </div>
            </section>

            <section id="benefits" class="pb-16 md:pb-24">
                 <div class="text-center">
                    <h2 class="text-3xl font-bold text-slate-800">Key Benefits & Outcomes</h2>
                    <p class="mt-3 max-w-2xl mx-auto text-lg text-slate-600">This automated workflow provides significant advantages over traditional manual processes, improving efficiency, security, and the end-user experience.</p>
                </div>
                <div class="mt-12 grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
                    <div>
                        <span data-value="95" class="stat-number text-5xl font-bold text-sky-600">0</span><span class="text-5xl font-bold text-sky-600">%</span>
                        <p class="mt-2 font-medium text-slate-600">Automation of Manual Work</p>
                    </div>
                     <div>
                        <span data-value="8500" class="stat-number text-5xl font-bold text-sky-600">0</span><span class="text-5xl font-bold text-sky-600">+</span>
                        <p class="mt-2 font-medium text-slate-600">Devices Scalable</p>
                    </div>
                     <div>
                        <span data-value="100" class="stat-number text-5xl font-bold text-sky-600">0</span><span class="text-5xl font-bold text-sky-600">%</span>
                        <p class="mt-2 font-medium text-slate-600">Build Consistency</p>
                    </div>
                    <div>
                        <span data-value="90" class="stat-number text-5xl font-bold text-sky-600">0</span><span class="text-5xl font-bold text-sky-600">%</span>
                        <p class="mt-2 font-medium text-slate-600">Cost Reduction</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="bg-slate-800 text-slate-300 py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-sm">
            <p class="mt-1">Built by Platform Engineering team, Snowflake.</p>
            <p class="mt-1">A modern and innovative approach to macOS fleet management.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Interactive Workflow Navigation ---
            const navContainer = document.getElementById('workflow-nav-container');
            const navLinks = navContainer.querySelectorAll('.nav-item');
            const sections = document.querySelectorAll('main section[id]');

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });

            // --- Highlight Nav on Scroll ---
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        navLinks.forEach(link => {
                            link.classList.toggle('active', link.dataset.target === id);
                        });
                    }
                });
            }, { rootMargin: '-40% 0px -60% 0px' });

            sections.forEach(section => {
                observer.observe(section);
            });

            // --- Chart.js Reporting Dashboard ---
            const ctx = document.getElementById('reportingChart').getContext('2d');
            const allData = {
                labels: ['Chrome', 'Zoom', 'Slack', '1Password', 'Firefox', 'Docker', 'VS Code'],
                datasets: [{
                    label: '% Patched',
                    data: [98, 92, 100, 85, 99, 70, 65],
                    backgroundColor: 'rgba(2, 132, 199, 0.6)', // sky-600
                    borderColor: 'rgba(2, 132, 199, 1)',
                    borderWidth: 1,
                    borderRadius: 4
                }]
            };
            const criticalData = {
                labels: ['Chrome', 'Zoom', 'Firefox'],
                datasets: [{
                    label: '% Patched',
                    data: [98, 92, 99],
                    backgroundColor: 'rgba(225, 29, 72, 0.6)', // rose-600
                    borderColor: 'rgba(225, 29, 72, 1)',
                    borderWidth: 1,
                    borderRadius: 4
                }]
            };

            let reportingChart = new Chart(ctx, {
                type: 'bar',
                data: allData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%'
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Compliance: ${context.parsed.y}%`;
                                }
                            }
                        }
                    }
                }
            });
            
            const filterAllBtn = document.getElementById('filter-all');
            const filterCriticalBtn = document.getElementById('filter-critical');
            
            function updateChart(data, activeBtn, inactiveBtn) {
                reportingChart.data = data;
                reportingChart.update();
                activeBtn.classList.add('bg-sky-600', 'text-white');
                activeBtn.classList.remove('bg-white', 'text-slate-600', 'border', 'border-slate-300');
                inactiveBtn.classList.add('bg-white', 'text-slate-600', 'border', 'border-slate-300');
                inactiveBtn.classList.remove('bg-sky-600', 'text-white');
            }

            filterAllBtn.addEventListener('click', () => {
                updateChart(allData, filterAllBtn, filterCriticalBtn);
            });
            
            filterCriticalBtn.addEventListener('click', () => {
                reportingChart.data = criticalData;
                reportingChart.update();
                filterCriticalBtn.classList.add('bg-sky-600', 'text-white');
                filterCriticalBtn.classList.remove('bg-white', 'text-slate-600', 'border', 'border-slate-300');
                filterAllBtn.classList.add('bg-white', 'text-slate-600', 'border', 'border-slate-300');
                filterAllBtn.classList.remove('bg-sky-600', 'text-white');
            });


            // --- Animated Stats on Scroll ---
            const statNumbers = document.querySelectorAll('.stat-number');
            const statsObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const el = entry.target;
                        const finalValue = parseInt(el.dataset.value, 10);
                        const duration = 1500;
                        let start = null;

                        function step(timestamp) {
                            if (!start) start = timestamp;
                            const progress = timestamp - start;
                            const current = Math.min(Math.floor(progress / duration * finalValue), finalValue);
                            el.textContent = current.toLocaleString();
                            if (current < finalValue) {
                                window.requestAnimationFrame(step);
                            }
                        }
                        window.requestAnimationFrame(step);
                        observer.unobserve(el);
                    }
                });
            }, { threshold: 0.5 });

            statNumbers.forEach(num => {
                statsObserver.observe(num);
            });

        });
    </script>
</body>
</html>
